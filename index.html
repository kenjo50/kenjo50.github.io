<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Chatbot auf GitHub Pages</title>
  <style>
    .chat-toggle{position:fixed;right:16px;bottom:16px;border:0;padding:12px 14px;border-radius:999px;box-shadow:0 6px 18px rgba(0,0,0,.2);cursor:pointer}
    .chatbox{position:fixed;right:16px;bottom:76px;width:340px;max-width:90vw;height:440px;display:none;flex-direction:column;border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,.25);overflow:hidden;background:#fff;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial}
    .chatbox header{padding:12px 14px;font-weight:600;border-bottom:1px solid #eee}
    .messages{flex:1;overflow:auto;padding:12px}
    .msg{margin:8px 0;max-width:85%}
    .msg.user{margin-left:auto;text-align:right}
    .msg .bubble{display:inline-block;padding:10px 12px;border-radius:12px;background:#f1f1f1;white-space:pre-wrap}
    .msg.user .bubble{background:#e6f0ff}
    form{display:flex;gap:8px;border-top:1px solid #eee;padding:10px}
    input[type="text"]{flex:1;padding:10px;border:1px solid #ddd;border-radius:8px}
    button.send,.chat-toggle{background:#111;color:#fff}
    button.send{padding:10px 12px;border:0;border-radius:8px;cursor:pointer}
  </style>
</head>
<body>
  <button class="chat-toggle">ðŸ’¬</button>
  <div class="chatbox" id="chatbox">
    <header>Chatbot</header>
    <div class="messages" id="messages"></div>
    <form id="chat-form" autocomplete="off">
      <input id="chat-input" type="text" placeholder="Nachricht eingebenâ€¦" />
      <button class="send" type="submit">Senden</button>
    </form>
  </div>

  <script>
    const PROXY_URL = "https://dein-worker.example.workers.dev/api/chat"; // <â€” hier deine Proxy-URL eintragen

    const toggle = document.querySelector('.chat-toggle');
    const box = document.getElementById('chatbox');
    const form = document.getElementById('chat-form');
    const input = document.getElementById('chat-input');
    const messages = document.getElementById('messages');

    const addMsg = (text, role='bot') => {
      const wrap = document.createElement('div');
      wrap.className = `msg ${role==='user'?'user':''}`;
      const bubble = document.createElement('div');
      bubble.className = 'bubble';
      bubble.textContent = text;
      wrap.appendChild(bubble);
      messages.appendChild(wrap);
      messages.scrollTop = messages.scrollHeight;
    };

    toggle.addEventListener('click', () => {
      box.style.display = (box.style.display === 'flex') ? 'none' : 'flex';
      if (box.style.display === 'flex') input.focus();
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      const text = input.value.trim();
      if (!text) return;
      addMsg(text, 'user');
      input.value = '';
      addMsg('â€¦denke nachâ€¦');

      try {
        const res = await fetch(PROXY_URL, {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify({ message: text })
        });
        const data = await res.json();
        messages.lastChild.querySelector('.bubble').textContent = data.reply ?? '(keine Antwort)';
      } catch (err) {
        messages.lastChild.querySelector('.bubble').textContent = 'Fehler bei der Anfrage.';
        console.error(err);
      }
    });
  </script>
</body>
</html>

